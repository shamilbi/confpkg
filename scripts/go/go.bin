#!/bin/bash

PkgHome="https://go.dev/"

unset pkg_configure pkg_make pkg_check

pkg_install() {
    #pkg_cp_fd . "$GoDir2"
    pkg_cp_dd . "$GoDir2" -l # hard links (too big dir)
    rm -f "$GoDir2"/src/*.bat

    # Slackware
    # remove tests, nothing needs these at runtime:
    find "$GoDir2"/src -type d -name "testdata" -exec rm -rf {} +
    find "$GoDir2"/src -type f -name "*_test.go" -delete

    ls -d "$GoDir2"/bin/* | pkg_ln_d "$Prefix2/bin"

    # Slackware
    # Create the profile scripts for setting PATH and env variables:
    mkdir -p "$Etc2"/profile.d
    cat >"$Etc2"/profile.d/go.csh <<EOF
#!/bin/csh
setenv GOROOT ${GoDir}
#setenv PATH \${GOROOT}/bin:\${PATH}
EOF
    cat >"$Etc2"/profile.d/go.sh <<EOF
#!/bin/sh
export GOROOT="${GoDir}"
#export PATH="\${GOROOT}/bin:\${PATH}"
EOF
    chmod 0755 "$Etc2"/profile.d/go.csh
    chmod 0755 "$Etc2"/profile.d/go.sh
}

pkg_distclean() {
    :
}
