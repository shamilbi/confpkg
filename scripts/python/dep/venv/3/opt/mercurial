#!/bin/bash

# error: the configured Python interpreter version (3.14) is newer than PyO3's maximum supported version (3.13)
# help: set PYO3_USE_ABI3_FORWARD_COMPATIBILITY=1 to suppress this check and build anyway using the stable ABI
export PYO3_USE_ABI3_FORWARD_COMPATIBILITY=1

if (($(pkg_cmp_versions "$Version" "7.2") < 0)); then
    export HGWITHRUSTEXT=cpython
else
    pkg_configure=1
    pkg_configure() {
        local fn=setup.py
        pkg_create_orig "$fn"
        sed -i -re 's,^( +)rust = False$,\1rust = True,' "$fn"
    }
fi
